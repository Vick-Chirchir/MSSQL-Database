1. List number of orders for each branch with their total purchase (SUBTOTAL), total shipping charge, total tax, and total purchases (there are 15 branches)
BRANCH#, #_ORDERS, TOTAL PURCHAES, TOTAL SHIPPING CHARGES, TOTAL TAXES, TOTAL OVERALL PURCHASE (3)



SELECT BRANCH_NO AS BRANCH#, COUNT(ORDER_NO)  "#_ORDERS", SUM(SUBTOTAL) "TOTAL PURCHASES",
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL PURCHASE" 
FROM ORDERS group by BRANCH_NO;

BRANCH#  #_ORDERS  TOTAL PURCHASES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL PURCHASE  
100      215       35,007,880       1,201,000.5             1,128,844.89983206  37,337,725.39983206     
113      79        28,680,995       724,648.75              547,658.3381066     29,953,302.0881066      
108      92        11,520,520       299,293                 291,221.227418505   12,111,034.227418505    
112      134       25,414,340       806,051.75              688,842.377751395   26,909,234.127751395    
102      74        20,175,110       417,434.75              625,424.680004265   21,217,969.430004265    
110      69        16,087,795       354,956.75              379,584.223156325   16,822,335.973156325    
114      48        9,036,135        362,634                 248,288.1489492     9,647,057.1489492       
101      120       11,957,615       399,867.5               618,095.66998343    12,975,578.16998343     
107      99        11,467,615       417,870                 230,812.80252824    12,116,297.80252824     
109      12        1,646,200        39,521.5                33,720.062723865    1,719,441.562723865     
104      114       14,439,605       267,779.25              758,152.883388945   15,465,537.133388945    
105      132       33,658,205       672,025.5               1,723,600.04568164  36,053,830.54568164     
111      70        13,796,770       293,268                 652,672.766048725   14,742,710.766048725    
103      82        9,939,950        229,557.25              346,684.32112789    10,516,191.57112789     

BRANCH#  #_ORDERS  TOTAL PURCHASES  TOTAL SHIPPING CHARGES  TOTAL TAXES        TOTAL OVERALL PURCHASE  
106      135       18,802,065       690,972.5               686,450.493682575  20,179,487.993682575    


 15 rows selected 



2. Redo Query 1 using ROLLUP (.5)


SELECT BRANCH_NO AS BRANCH#, COUNT(ORDER_NO)  "#_ORDERS", SUM(SUBTOTAL) "TOTAL PURCHASES",
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL PURCHASE" 
FROM ORDERS 
group by ROLLUP(BRANCH_NO)
ORDER BY 1;

BRANCH#  #_ORDERS  TOTAL PURCHASES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL PURCHASE  
100      215       35,007,880       1,201,000.5             1,128,844.89983206  37,337,725.39983206     
101      120       11,957,615       399,867.5               618,095.66998343    12,975,578.16998343     
102      74        20,175,110       417,434.75              625,424.680004265   21,217,969.430004265    
103      82        9,939,950        229,557.25              346,684.32112789    10,516,191.57112789     
104      114       14,439,605       267,779.25              758,152.883388945   15,465,537.133388945    
105      132       33,658,205       672,025.5               1,723,600.04568164  36,053,830.54568164     
106      135       18,802,065       690,972.5               686,450.493682575   20,179,487.993682575    
107      99        11,467,615       417,870                 230,812.80252824    12,116,297.80252824     
108      92        11,520,520       299,293                 291,221.227418505   12,111,034.227418505    
109      12        1,646,200        39,521.5                33,720.062723865    1,719,441.562723865     
110      69        16,087,795       354,956.75              379,584.223156325   16,822,335.973156325    
111      70        13,796,770       293,268                 652,672.766048725   14,742,710.766048725    
112      134       25,414,340       806,051.75              688,842.377751395   26,909,234.127751395    
113      79        28,680,995       724,648.75              547,658.3381066     29,953,302.0881066      

BRANCH#  #_ORDERS  TOTAL PURCHASES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL PURCHASE  
114      48        9,036,135        362,634                 248,288.1489492     9,647,057.1489492       
         1,475     261,630,800      7,176,881               8,960,052.94038366  277,767,733.94038366    


 16 rows selected 



3. Redo Query 1 using CUBE. (.5)

SELECT BRANCH_NO AS BRANCH#, COUNT(ORDER_NO)  "#_ORDERS", SUM(SUBTOTAL) "TOTAL PURCHASES",
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL PURCHASE" FROM ORDERS 
group by CUBE(BRANCH_NO)
ORDER BY 1;

BRANCH#  #_ORDERS  TOTAL PURCHASES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL PURCHASE  
100      215       35,007,880       1,201,000.5             1,128,844.89983206  37,337,725.39983206     
101      120       11,957,615       399,867.5               618,095.66998343    12,975,578.16998343     
102      74        20,175,110       417,434.75              625,424.680004265   21,217,969.430004265    
103      82        9,939,950        229,557.25              346,684.32112789    10,516,191.57112789     
104      114       14,439,605       267,779.25              758,152.883388945   15,465,537.133388945    
105      132       33,658,205       672,025.5               1,723,600.04568164  36,053,830.54568164     
106      135       18,802,065       690,972.5               686,450.493682575   20,179,487.993682575    
107      99        11,467,615       417,870                 230,812.80252824    12,116,297.80252824     
108      92        11,520,520       299,293                 291,221.227418505   12,111,034.227418505    
109      12        1,646,200        39,521.5                33,720.062723865    1,719,441.562723865     
110      69        16,087,795       354,956.75              379,584.223156325   16,822,335.973156325    
111      70        13,796,770       293,268                 652,672.766048725   14,742,710.766048725    
112      134       25,414,340       806,051.75              688,842.377751395   26,909,234.127751395    
113      79        28,680,995       724,648.75              547,658.3381066     29,953,302.0881066      

BRANCH#  #_ORDERS  TOTAL PURCHASES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL PURCHASE  
114      48        9,036,135        362,634                 248,288.1489492     9,647,057.1489492       
         1,475     261,630,800      7,176,881               8,960,052.94038366  277,767,733.94038366    


 16 rows selected


4. Redo query 1 by adding Rank to each branch based on total sales (1)


SELECT BRANCH_NO AS BRANCH#, COUNT(ORDER_NO)  "#_ORDERS", SUM(SUBTOTAL) "TOTAL PURCHASES",
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL PURCHASE",
RANK() OVER ( ORDER BY SUM(SUBTOTAL) Desc) AS RANK 
FROM ORDERS group by BRANCH_NO;


BRANCH#  #_ORDERS  TOTAL PURCHASES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL PURCHASE  RANK  
100      215       35,007,880       1,201,000.5             1,128,844.89983206  37,337,725.39983206     1     
105      132       33,658,205       672,025.5               1,723,600.04568164  36,053,830.54568164     2     
113      79        28,680,995       724,648.75              547,658.3381066     29,953,302.0881066      3     
112      134       25,414,340       806,051.75              688,842.377751395   26,909,234.127751395    4     
102      74        20,175,110       417,434.75              625,424.680004265   21,217,969.430004265    5     
106      135       18,802,065       690,972.5               686,450.493682575   20,179,487.993682575    6     
110      69        16,087,795       354,956.75              379,584.223156325   16,822,335.973156325    7     
104      114       14,439,605       267,779.25              758,152.883388945   15,465,537.133388945    8     
111      70        13,796,770       293,268                 652,672.766048725   14,742,710.766048725    9     
101      120       11,957,615       399,867.5               618,095.66998343    12,975,578.16998343     10    
108      92        11,520,520       299,293                 291,221.227418505   12,111,034.227418505    11    
107      99        11,467,615       417,870                 230,812.80252824    12,116,297.80252824     12    
103      82        9,939,950        229,557.25              346,684.32112789    10,516,191.57112789     13    
114      48        9,036,135        362,634                 248,288.1489492     9,647,057.1489492       14    

BRANCH#  #_ORDERS  TOTAL PURCHASES  TOTAL SHIPPING CHARGES  TOTAL TAXES       TOTAL OVERALL PURCHASE  RANK  
109      12        1,646,200        39,521.5                33,720.062723865  1,719,441.562723865     15    


 15 rows selected 


5. Redo query 1 by showing percentage of purchases/ or sales for each branch (2)

SELECT BRANCH_NO AS BRANCH#, COUNT(ORDER_NO)  "#_ORDERS", SUM(SUBTOTAL) "TOTAL PURCHASES",
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL PURCHASE",
NTILE(4) OVER ( ORDER BY  SUM(SUBTOTAL) DESC NULLS LAST) Quartile
FROM ORDERS group by BRANCH_NO;


BRANCH#  #_ORDERS  TOTAL PURCHASES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL PURCHASE  QUARTILE  
100      215       35,007,880       1,201,000.5             1,128,844.89983206  37,337,725.39983206     1         
105      132       33,658,205       672,025.5               1,723,600.04568164  36,053,830.54568164     1         
113      79        28,680,995       724,648.75              547,658.3381066     29,953,302.0881066      1         
112      134       25,414,340       806,051.75              688,842.377751395   26,909,234.127751395    1         
102      74        20,175,110       417,434.75              625,424.680004265   21,217,969.430004265    2         
106      135       18,802,065       690,972.5               686,450.493682575   20,179,487.993682575    2         
110      69        16,087,795       354,956.75              379,584.223156325   16,822,335.973156325    2         
104      114       14,439,605       267,779.25              758,152.883388945   15,465,537.133388945    2         
111      70        13,796,770       293,268                 652,672.766048725   14,742,710.766048725    3         
101      120       11,957,615       399,867.5               618,095.66998343    12,975,578.16998343     3         
108      92        11,520,520       299,293                 291,221.227418505   12,111,034.227418505    3         
107      99        11,467,615       417,870                 230,812.80252824    12,116,297.80252824     3         
103      82        9,939,950        229,557.25              346,684.32112789    10,516,191.57112789     4         
114      48        9,036,135        362,634                 248,288.1489492     9,647,057.1489492       4         

BRANCH#  #_ORDERS  TOTAL PURCHASES  TOTAL SHIPPING CHARGES  TOTAL TAXES       TOTAL OVERALL PURCHASE  QUARTILE  
109      12        1,646,200        39,521.5                33,720.062723865  1,719,441.562723865     4         


 15 rows selected 



6. List number of employees with their total sales (SUBTOTAL), total shipping charge, total tax, and overall total SALESs.
EMPLOYEE_NO, TOTAL SALES, TOTAL SHIPPING CHARGES, TOTAL TAXES, TOTAL OVERALL SALES (3)

SELECT EMPLOYEE_NO, SUM(SUBTOTAL) "TOTAL SALES", 
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL SALES"
FROM ORDERS 
GROUP BY EMPLOYEE_NO;

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL SALES   
1,003        6,295,955    222,931.75              331,579.4598312     6,850,466.2098312     
1,013        1,468,275    71,055                  54,502.24546452     1,593,832.24546452    
1,036        33,658,205   672,025.5               1,723,600.04568164  36,053,830.54568164   
1,042        11,520,520   299,293                 291,221.227418505   12,111,034.227418505  
1,047        7,553,635    223,960.75              146,228.001459505   7,923,823.751459505   
1,046        4,406,000    98,681                  64,118.17473448     4,568,799.17473448    
1,065        4,779,950    103,045.75              92,261.04141973     4,975,256.79141973    
1,076        3,693,450    149,226                 9,194.479128665     3,851,870.479128665   
1,016        1,189,085    3,459.5                 65,839.00642941     1,258,383.50642941    
1,024        7,901,010    249,071.75              372,539.35          8,522,621.1           
1,030        505,455      20,938                  2,595.921875        528,988.921875        
1,062        3,153,645    140,525.75              166,333.513212205   3,460,504.263212205   
1,054        8,024,410    165,679                 81,560.53103774     8,271,649.53103774    
1,006        694,675      28,350.5                10,673.98248899     733,699.48248899      

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES        TOTAL OVERALL SALES   
1,088        4,528,620    214,725                 221,476.183970625  4,964,821.183970625   
1,032        6,222,500    126,039                 349,600.662101895  6,698,139.662101895   
1,060        3,162,200    94,279.75               80,353.85647575    3,336,833.60647575    
1,069        7,923,635    316,936                 310,998.881555515  8,551,569.881555515   
1,070        15,282,965   313,731.75              146,618.792979625  15,743,315.542979625  
1,002        4,160,045    152,304.75              69,603.39430927    4,381,953.14430927    
1,029        4,144,340    113,390.75              116,427.07034698   4,374,157.82034698    
1,033        7,345,475    138,759.75              361,905.234863775  7,846,139.984863775   
1,034        871,630      2,980.5                 46,646.986423275   921,257.486423275     
1,038        11,489,815   351,164.25              330,187.080872285  12,171,166.330872285  
1,061        7,480,925    58,462.5                405,985.39636077   7,945,372.89636077    
1,022        8,070,985    133,615.5               180,294.918744045  8,384,895.418744045   
1,028        5,290,155    95,228.5                227,661.32890591   5,613,044.82890591    
1,039        7,312,250    339,808.25              356,263.41281029   8,008,321.66281029    

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES        TOTAL OVERALL SALES  
1,071        5,474,395    93,981                  90,040.66357146    5,658,416.66357146   
1,004        2,765,245    72,210.25               108,638.552617515  2,946,093.802617515  
1,015        2,969,530    55,844.25               176,703.206561765  3,202,077.456561765  
1,066        10,280,555   240,360.75              193,744.1785181    10,714,659.9285181   
1,077        2,919,685    124,399                 134,177.647532785  3,178,261.647532785  
1,008        3,526,265    162,696.75              95,994.937684535   3,784,956.687684535  
1,005        2,723,640    64,661.25               114,252.275459805  2,902,553.525459805  
1,014        4,383,000    181,657.5               194,876.96304818   4,759,534.46304818   
1,084        5,376,340    227,653                 126,783.813792505  5,730,776.813792505  
1,045        11,467,615   417,870                 230,812.80252824   12,116,297.80252824  
1,078        2,423,000    89,009                  104,916.02228775   2,616,925.02228775   
1,067        4,977,495    234,992.25              276,053.34402106   5,488,540.59402106   
1,053        5,526,420    85,976.75               130,559.55156679   5,742,956.30156679   
1,080        1,947,725    87,851.25               126,174.248479555  2,161,750.498479555  

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES        TOTAL OVERALL SALES  
1,023        4,203,115    34,747.5                72,590.41126022    4,310,452.91126022   
1,086        2,536,965    103,301                 167,464.140551795  2,807,730.140551795  


 44 rows selected 

7. Redo Query 6 using ROLLUP (.5)


SELECT EMPLOYEE_NO, SUM(SUBTOTAL) "TOTAL SALES", 
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL SALES"
FROM ORDERS 
GROUP BY ROLLUP(EMPLOYEE_NO)
ORDER BY 1;


EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES        TOTAL OVERALL SALES  
1,002        4,160,045    152,304.75              69,603.39430927    4,381,953.14430927   
1,003        6,295,955    222,931.75              331,579.4598312    6,850,466.2098312    
1,004        2,765,245    72,210.25               108,638.552617515  2,946,093.802617515  
1,005        2,723,640    64,661.25               114,252.275459805  2,902,553.525459805  
1,006        694,675      28,350.5                10,673.98248899    733,699.48248899     
1,008        3,526,265    162,696.75              95,994.937684535   3,784,956.687684535  
1,013        1,468,275    71,055                  54,502.24546452    1,593,832.24546452   
1,014        4,383,000    181,657.5               194,876.96304818   4,759,534.46304818   
1,015        2,969,530    55,844.25               176,703.206561765  3,202,077.456561765  
1,016        1,189,085    3,459.5                 65,839.00642941    1,258,383.50642941   
1,022        8,070,985    133,615.5               180,294.918744045  8,384,895.418744045  
1,023        4,203,115    34,747.5                72,590.41126022    4,310,452.91126022   
1,024        7,901,010    249,071.75              372,539.35         8,522,621.1          
1,028        5,290,155    95,228.5                227,661.32890591   5,613,044.82890591   

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL SALES   
1,029        4,144,340    113,390.75              116,427.07034698    4,374,157.82034698    
1,030        505,455      20,938                  2,595.921875        528,988.921875        
1,032        6,222,500    126,039                 349,600.662101895   6,698,139.662101895   
1,033        7,345,475    138,759.75              361,905.234863775   7,846,139.984863775   
1,034        871,630      2,980.5                 46,646.986423275    921,257.486423275     
1,036        33,658,205   672,025.5               1,723,600.04568164  36,053,830.54568164   
1,038        11,489,815   351,164.25              330,187.080872285   12,171,166.330872285  
1,039        7,312,250    339,808.25              356,263.41281029    8,008,321.66281029    
1,042        11,520,520   299,293                 291,221.227418505   12,111,034.227418505  
1,045        11,467,615   417,870                 230,812.80252824    12,116,297.80252824   
1,046        4,406,000    98,681                  64,118.17473448     4,568,799.17473448    
1,047        7,553,635    223,960.75              146,228.001459505   7,923,823.751459505   
1,053        5,526,420    85,976.75               130,559.55156679    5,742,956.30156679    
1,054        8,024,410    165,679                 81,560.53103774     8,271,649.53103774    

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES        TOTAL OVERALL SALES   
1,060        3,162,200    94,279.75               80,353.85647575    3,336,833.60647575    
1,061        7,480,925    58,462.5                405,985.39636077   7,945,372.89636077    
1,062        3,153,645    140,525.75              166,333.513212205  3,460,504.263212205   
1,065        4,779,950    103,045.75              92,261.04141973    4,975,256.79141973    
1,066        10,280,555   240,360.75              193,744.1785181    10,714,659.9285181    
1,067        4,977,495    234,992.25              276,053.34402106   5,488,540.59402106    
1,069        7,923,635    316,936                 310,998.881555515  8,551,569.881555515   
1,070        15,282,965   313,731.75              146,618.792979625  15,743,315.542979625  
1,071        5,474,395    93,981                  90,040.66357146    5,658,416.66357146    
1,076        3,693,450    149,226                 9,194.479128665    3,851,870.479128665   
1,077        2,919,685    124,399                 134,177.647532785  3,178,261.647532785   
1,078        2,423,000    89,009                  104,916.02228775   2,616,925.02228775    
1,080        1,947,725    87,851.25               126,174.248479555  2,161,750.498479555   
1,084        5,376,340    227,653                 126,783.813792505  5,730,776.813792505   

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL SALES   
1,086        2,536,965    103,301                 167,464.140551795   2,807,730.140551795   
1,088        4,528,620    214,725                 221,476.183970625   4,964,821.183970625   
             261,630,800  7,176,881               8,960,052.94038366  277,767,733.94038366  


 45 rows selected 


8. Redo Query 6 using CUBE. (.5)

SELECT EMPLOYEE_NO, SUM(SUBTOTAL) "TOTAL SALES", 
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL SALES"
FROM ORDERS
GROUP BY CUBE(EMPLOYEE_NO)
ORDER BY 1;

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES        TOTAL OVERALL SALES  
1,002        4,160,045    152,304.75              69,603.39430927    4,381,953.14430927   
1,003        6,295,955    222,931.75              331,579.4598312    6,850,466.2098312    
1,004        2,765,245    72,210.25               108,638.552617515  2,946,093.802617515  
1,005        2,723,640    64,661.25               114,252.275459805  2,902,553.525459805  
1,006        694,675      28,350.5                10,673.98248899    733,699.48248899     
1,008        3,526,265    162,696.75              95,994.937684535   3,784,956.687684535  
1,013        1,468,275    71,055                  54,502.24546452    1,593,832.24546452   
1,014        4,383,000    181,657.5               194,876.96304818   4,759,534.46304818   
1,015        2,969,530    55,844.25               176,703.206561765  3,202,077.456561765  
1,016        1,189,085    3,459.5                 65,839.00642941    1,258,383.50642941   
1,022        8,070,985    133,615.5               180,294.918744045  8,384,895.418744045  
1,023        4,203,115    34,747.5                72,590.41126022    4,310,452.91126022   
1,024        7,901,010    249,071.75              372,539.35         8,522,621.1          
1,028        5,290,155    95,228.5                227,661.32890591   5,613,044.82890591   

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL SALES   
1,029        4,144,340    113,390.75              116,427.07034698    4,374,157.82034698    
1,030        505,455      20,938                  2,595.921875        528,988.921875        
1,032        6,222,500    126,039                 349,600.662101895   6,698,139.662101895   
1,033        7,345,475    138,759.75              361,905.234863775   7,846,139.984863775   
1,034        871,630      2,980.5                 46,646.986423275    921,257.486423275     
1,036        33,658,205   672,025.5               1,723,600.04568164  36,053,830.54568164   
1,038        11,489,815   351,164.25              330,187.080872285   12,171,166.330872285  
1,039        7,312,250    339,808.25              356,263.41281029    8,008,321.66281029    
1,042        11,520,520   299,293                 291,221.227418505   12,111,034.227418505  
1,045        11,467,615   417,870                 230,812.80252824    12,116,297.80252824   
1,046        4,406,000    98,681                  64,118.17473448     4,568,799.17473448    
1,047        7,553,635    223,960.75              146,228.001459505   7,923,823.751459505   
1,053        5,526,420    85,976.75               130,559.55156679    5,742,956.30156679    
1,054        8,024,410    165,679                 81,560.53103774     8,271,649.53103774    

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES        TOTAL OVERALL SALES   
1,060        3,162,200    94,279.75               80,353.85647575    3,336,833.60647575    
1,061        7,480,925    58,462.5                405,985.39636077   7,945,372.89636077    
1,062        3,153,645    140,525.75              166,333.513212205  3,460,504.263212205   
1,065        4,779,950    103,045.75              92,261.04141973    4,975,256.79141973    
1,066        10,280,555   240,360.75              193,744.1785181    10,714,659.9285181    
1,067        4,977,495    234,992.25              276,053.34402106   5,488,540.59402106    
1,069        7,923,635    316,936                 310,998.881555515  8,551,569.881555515   
1,070        15,282,965   313,731.75              146,618.792979625  15,743,315.542979625  
1,071        5,474,395    93,981                  90,040.66357146    5,658,416.66357146    
1,076        3,693,450    149,226                 9,194.479128665    3,851,870.479128665   
1,077        2,919,685    124,399                 134,177.647532785  3,178,261.647532785   
1,078        2,423,000    89,009                  104,916.02228775   2,616,925.02228775    
1,080        1,947,725    87,851.25               126,174.248479555  2,161,750.498479555   
1,084        5,376,340    227,653                 126,783.813792505  5,730,776.813792505   

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL SALES   
1,086        2,536,965    103,301                 167,464.140551795   2,807,730.140551795   
1,088        4,528,620    214,725                 221,476.183970625   4,964,821.183970625   
             261,630,800  7,176,881               8,960,052.94038366  277,767,733.94038366  


 45 rows selected

9. Redo query 6 by adding Rank EMPLOYEES based on total SALES (2)

SELECT EMPLOYEE_NO, SUM(SUBTOTAL) "TOTAL SALES", 
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL SALES",
RANK() OVER ( ORDER BY SUM(SUBTOTAL) Desc) AS RANK 
FROM ORDERS 
GROUP BY EMPLOYEE_NO;


EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL SALES   RANK  
1,036        33,658,205   672,025.5               1,723,600.04568164  36,053,830.54568164   1     
1,070        15,282,965   313,731.75              146,618.792979625   15,743,315.542979625  2     
1,042        11,520,520   299,293                 291,221.227418505   12,111,034.227418505  3     
1,038        11,489,815   351,164.25              330,187.080872285   12,171,166.330872285  4     
1,045        11,467,615   417,870                 230,812.80252824    12,116,297.80252824   5     
1,066        10,280,555   240,360.75              193,744.1785181     10,714,659.9285181    6     
1,022        8,070,985    133,615.5               180,294.918744045   8,384,895.418744045   7     
1,054        8,024,410    165,679                 81,560.53103774     8,271,649.53103774    8     
1,069        7,923,635    316,936                 310,998.881555515   8,551,569.881555515   9     
1,024        7,901,010    249,071.75              372,539.35          8,522,621.1           10    
1,047        7,553,635    223,960.75              146,228.001459505   7,923,823.751459505   11    
1,061        7,480,925    58,462.5                405,985.39636077    7,945,372.89636077    12    
1,033        7,345,475    138,759.75              361,905.234863775   7,846,139.984863775   13    
1,039        7,312,250    339,808.25              356,263.41281029    8,008,321.66281029    14    

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES        TOTAL OVERALL SALES  RANK  
1,003        6,295,955    222,931.75              331,579.4598312    6,850,466.2098312    15    
1,032        6,222,500    126,039                 349,600.662101895  6,698,139.662101895  16    
1,053        5,526,420    85,976.75               130,559.55156679   5,742,956.30156679   17    
1,071        5,474,395    93,981                  90,040.66357146    5,658,416.66357146   18    
1,084        5,376,340    227,653                 126,783.813792505  5,730,776.813792505  19    
1,028        5,290,155    95,228.5                227,661.32890591   5,613,044.82890591   20    
1,067        4,977,495    234,992.25              276,053.34402106   5,488,540.59402106   21    
1,065        4,779,950    103,045.75              92,261.04141973    4,975,256.79141973   22    
1,088        4,528,620    214,725                 221,476.183970625  4,964,821.183970625  23    
1,046        4,406,000    98,681                  64,118.17473448    4,568,799.17473448   24    
1,014        4,383,000    181,657.5               194,876.96304818   4,759,534.46304818   25    
1,023        4,203,115    34,747.5                72,590.41126022    4,310,452.91126022   26    
1,002        4,160,045    152,304.75              69,603.39430927    4,381,953.14430927   27    
1,029        4,144,340    113,390.75              116,427.07034698   4,374,157.82034698   28    

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES        TOTAL OVERALL SALES  RANK  
1,076        3,693,450    149,226                 9,194.479128665    3,851,870.479128665  29    
1,008        3,526,265    162,696.75              95,994.937684535   3,784,956.687684535  30    
1,060        3,162,200    94,279.75               80,353.85647575    3,336,833.60647575   31    
1,062        3,153,645    140,525.75              166,333.513212205  3,460,504.263212205  32    
1,015        2,969,530    55,844.25               176,703.206561765  3,202,077.456561765  33    
1,077        2,919,685    124,399                 134,177.647532785  3,178,261.647532785  34    
1,004        2,765,245    72,210.25               108,638.552617515  2,946,093.802617515  35    
1,005        2,723,640    64,661.25               114,252.275459805  2,902,553.525459805  36    
1,086        2,536,965    103,301                 167,464.140551795  2,807,730.140551795  37    
1,078        2,423,000    89,009                  104,916.02228775   2,616,925.02228775   38    
1,080        1,947,725    87,851.25               126,174.248479555  2,161,750.498479555  39    
1,013        1,468,275    71,055                  54,502.24546452    1,593,832.24546452   40    
1,016        1,189,085    3,459.5                 65,839.00642941    1,258,383.50642941   41    
1,034        871,630      2,980.5                 46,646.986423275   921,257.486423275    42    

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES      TOTAL OVERALL SALES  RANK  
1,006        694,675      28,350.5                10,673.98248899  733,699.48248899     43    
1,030        505,455      20,938                  2,595.921875     528,988.921875       44    


 44 rows selected 



10. Redo query 6 by showing percentage of sales/ or sales for each state (2)
			PRODUCT_CATEGORY	QTY_SOLD
SELECT EMPLOYEE_NO, SUM(SUBTOTAL) "TOTAL SALES", 
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL SALES",
NTILE(4) OVER ( ORDER BY  SUM(SUBTOTAL) DESC NULLS LAST) Quartile
FROM ORDERS 
GROUP BY EMPLOYEE_NO;

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES         TOTAL OVERALL SALES   QUARTILE  
1,036        33,658,205   672,025.5               1,723,600.04568164  36,053,830.54568164   1         
1,070        15,282,965   313,731.75              146,618.792979625   15,743,315.542979625  1         
1,042        11,520,520   299,293                 291,221.227418505   12,111,034.227418505  1         
1,038        11,489,815   351,164.25              330,187.080872285   12,171,166.330872285  1         
1,045        11,467,615   417,870                 230,812.80252824    12,116,297.80252824   1         
1,066        10,280,555   240,360.75              193,744.1785181     10,714,659.9285181    1         
1,022        8,070,985    133,615.5               180,294.918744045   8,384,895.418744045   1         
1,054        8,024,410    165,679                 81,560.53103774     8,271,649.53103774    1         
1,069        7,923,635    316,936                 310,998.881555515   8,551,569.881555515   1         
1,024        7,901,010    249,071.75              372,539.35          8,522,621.1           1         
1,047        7,553,635    223,960.75              146,228.001459505   7,923,823.751459505   1         
1,061        7,480,925    58,462.5                405,985.39636077    7,945,372.89636077    2         
1,033        7,345,475    138,759.75              361,905.234863775   7,846,139.984863775   2         
1,039        7,312,250    339,808.25              356,263.41281029    8,008,321.66281029    2         

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES        TOTAL OVERALL SALES  QUARTILE  
1,003        6,295,955    222,931.75              331,579.4598312    6,850,466.2098312    2         
1,032        6,222,500    126,039                 349,600.662101895  6,698,139.662101895  2         
1,053        5,526,420    85,976.75               130,559.55156679   5,742,956.30156679   2         
1,071        5,474,395    93,981                  90,040.66357146    5,658,416.66357146   2         
1,084        5,376,340    227,653                 126,783.813792505  5,730,776.813792505  2         
1,028        5,290,155    95,228.5                227,661.32890591   5,613,044.82890591   2         
1,067        4,977,495    234,992.25              276,053.34402106   5,488,540.59402106   2         
1,065        4,779,950    103,045.75              92,261.04141973    4,975,256.79141973   2         
1,088        4,528,620    214,725                 221,476.183970625  4,964,821.183970625  3         
1,046        4,406,000    98,681                  64,118.17473448    4,568,799.17473448   3         
1,014        4,383,000    181,657.5               194,876.96304818   4,759,534.46304818   3         
1,023        4,203,115    34,747.5                72,590.41126022    4,310,452.91126022   3         
1,002        4,160,045    152,304.75              69,603.39430927    4,381,953.14430927   3         
1,029        4,144,340    113,390.75              116,427.07034698   4,374,157.82034698   3         

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES        TOTAL OVERALL SALES  QUARTILE  
1,076        3,693,450    149,226                 9,194.479128665    3,851,870.479128665  3         
1,008        3,526,265    162,696.75              95,994.937684535   3,784,956.687684535  3         
1,060        3,162,200    94,279.75               80,353.85647575    3,336,833.60647575   3         
1,062        3,153,645    140,525.75              166,333.513212205  3,460,504.263212205  3         
1,015        2,969,530    55,844.25               176,703.206561765  3,202,077.456561765  3         
1,077        2,919,685    124,399                 134,177.647532785  3,178,261.647532785  4         
1,004        2,765,245    72,210.25               108,638.552617515  2,946,093.802617515  4         
1,005        2,723,640    64,661.25               114,252.275459805  2,902,553.525459805  4         
1,086        2,536,965    103,301                 167,464.140551795  2,807,730.140551795  4         
1,078        2,423,000    89,009                  104,916.02228775   2,616,925.02228775   4         
1,080        1,947,725    87,851.25               126,174.248479555  2,161,750.498479555  4         
1,013        1,468,275    71,055                  54,502.24546452    1,593,832.24546452   4         
1,016        1,189,085    3,459.5                 65,839.00642941    1,258,383.50642941   4         
1,034        871,630      2,980.5                 46,646.986423275   921,257.486423275    4         

EMPLOYEE_NO  TOTAL SALES  TOTAL SHIPPING CHARGES  TOTAL TAXES      TOTAL OVERALL SALES  QUARTILE  
1,006        694,675      28,350.5                10,673.98248899  733,699.48248899     4         
1,030        505,455      20,938                  2,595.921875     528,988.921875       4         


 44 rows selected 




11. List all product NUMBERs, PRODUCT_CATEGORY, and number of products sold (2)
			PRODUCT_NUMBER, PRODUCT_CATEGORY, QTY_SOLD

SELECT PRODUCT_NO AS PRODUCT_NUMBER,PRODUCT_CATEGORY,ORDER_QTY AS QTY_SOLD FROM PRODUCT;

PRODUCT_NUMBER PRODUCT_CATEGOR   QTY_SOLD
-------------- --------------- ----------
           120 Game                    20
           140 Game                    35
           130 Game                    40
           110 Game                      
           150 Game                    20
           160 Entertainment            5
           170 Entertainment            5
           180 Software                25
           190 Software                25
           200 Hardware                60

 10 rows selected 


12. List TOP 25% of customers (customer number, customer last name) based on total net purchases ( their total subtotal – their total amount returned) (3)

SELECT CS.CUSTOMER_NO,CS.LNAME, 
NTILE(4) OVER ( ORDER BY SUM(O.SUBTOTAL)-SUM(O.TOTAL_AMT)  DESC NULLS LAST) Quartile
FROM ORDERS O
JOIN CUSTOMER CS ON CS.CUSTOMER_NO = O.CUSTOMER_NO
group by CS.CUSTOMER_NO,CS.LNAME;


CUSTOMER_NO LNAME          QUARTILE
----------- ------------ ----------
       1036 Claggett              1
       1032 Farmer                1
       1059 Geriach               1
       1031 Pregmon               1
       1049 Keting                1
       1034 Mudd                  1
       1080  Nagal                1
       1030 Somers                1
       1043 Worral                1
       1052 Albright              1
       1024 Aslam                 1

CUSTOMER_NO LNAME          QUARTILE
----------- ------------ ----------
       1051 Bixler                1
       1029 Jake                  1
       1054 Ripkin                1
       1053 Dupont                1
       1074 Johnson               1
       1035 Katz                  1
       1037 Bixler                1
       1050 Simmins               1
       1042 Murthy                1
       1046 Martin                1
       1044 Wright                1

CUSTOMER_NO LNAME          QUARTILE
----------- ------------ ----------
       1038 Dunn                  1
       1033 Prouty                1
       1093 Bixler                1
       1069 Wehland               1
       1081 Doering               1



105 rows selected 

NOTE: 25% OF 105 ROWS IS 27 ROWS
`	