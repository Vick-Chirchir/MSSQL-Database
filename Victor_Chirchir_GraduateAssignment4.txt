/*1. List number of orders for each branch with their total purchase (SUBTOTAL), total shipping charge, total tax, and total purchases (there are 15 branches)
BRANCH#, #_ORDERS, TOTAL PURCHAES, TOTAL SHIPPING CHARGES, TOTAL TAXES, TOTAL OVERALL PURCHASE (3)*/


SELECT BRANCH_NO AS BRANCH#, COUNT(ORDER_NO)  "#_ORDERS", SUM(SUBTOTAL) "TOTAL PURCHASES",
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL PURCHASE" 
FROM ORDERS group by BRANCH_NO;



108	92	0		0		133910	0
114	48	0		0		111622	0
113	79	0		0		140410	0
100	215	1838735	109304	507588	2042923
112	134	0		0		257258	0
105	132	0		0		282689	0
107	99	0		0		196627	0
106	135	0		0		299905	0
102	74	0		0		93770		0
109	12	0		0		76300		0
103	82	0		0		161407	0
110	69	0		0		103744	0
101	120	881000	34600		338430	985000
111	70	0		0		76399		0
104	114	0		0		166000	0



/*2. Redo Query 1 using ROLLUP (.5)*/


SELECT BRANCH_NO AS BRANCH#, COUNT(ORDER_NO)  "#_ORDERS", SUM(SUBTOTAL) "TOTAL PURCHASES",
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL PURCHASE" 
FROM ORDERS 
group by ROLLUP(BRANCH_NO)
ORDER BY 1;



NULL   1475	2719735	143904	2946059	3027923
100	 215	1838735	109304	507588	2042923
101	 120	881000	34600		338430	985000
102	 74	0		0		93770		0
103	 82	0		0		161407	0
104	 114	0		0		166000	0
105	 132	0		0		282689	0
106	 135	0		0		299905	0
107	 99	0		0		196627	0
108	 92	0		0		133910	0
109	 12	0		0		76300		0
110	 69	0		0		103744	0
111	 70	0		0		76399		0
112	 134	0		0		257258	0
113	 79	0		0		140410	0
114	 48	0		0		111622	0



3. Redo Query 1 using CUBE. (.5)

SELECT BRANCH_NO AS BRANCH#, COUNT(ORDER_NO)  "#_ORDERS", SUM(SUBTOTAL) "TOTAL PURCHASES",
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL PURCHASE" FROM ORDERS 
group by CUBE(BRANCH_NO)
ORDER BY 1;


NULL 	1475	2719735	143904	2946059	3027923
100	 215	1838735	109304	507588	2042923
101	 120	881000	34600		338430	985000
102	 74	0		0		93770		0
103	 82	0		0		161407	0
104	 114	0		0		166000	0
105	 132	0		0		282689	0
106	 135	0		0		299905	0
107	 99	0		0		196627	0
108	 92	0		0		133910	0
109	 12	0		0		76300		0
110	 69	0		0		103744	0
111	 70	0		0		76399		0
112	 134	0		0		257258	0
113	 79	0		0		140410	0
114	 48	0		0		111622	0



4. Redo query 1 by adding Rank to each branch based on total sales (1)


SELECT BRANCH_NO AS BRANCH#, COUNT(ORDER_NO)  "#_ORDERS", SUM(SUBTOTAL) "TOTAL PURCHASES",
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL PURCHASE",
RANK() OVER ( ORDER BY SUM(SUBTOTAL) Desc) AS RANK 
FROM ORDERS group by BRANCH_NO;



100	215	1838735	109304	507588	2042923	1
101	120	881000	34600		338430	985000	2
111	70	0		0		76399		0		3
104	114	0		0		166000	0		3
108	92	0		0		133910	0		3
114	48	0		0		111622	0		3
113	79	0		0		140410	0		3
112	134	0		0		257258	0		3
105	132	0		0		282689	0		3
107	99	0		0		196627	0		3
106	135	0		0		299905	0		3
102	74	0		0		93770		0		3
109	12	0		0		76300		0		3
103	82	0		0		161407	0		3
110	69	0		0		103744	0		3




5. Redo query 1 by showing percentage of purchases/ or sales for each branch (2)

SELECT BRANCH_NO AS BRANCH#, COUNT(ORDER_NO)  "#_ORDERS", SUM(SUBTOTAL) "TOTAL PURCHASES",
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL PURCHASE",
NTILE(4) OVER ( ORDER BY  SUM(SUBTOTAL) DESC ) Quartile
FROM ORDERS group by BRANCH_NO;


100	215	1838735	109304	507588	2042923	1
101	120	881000	34600		338430	985000	1
111	70	0		0		76399		0		1
104	114	0		0		166000	0		1
108	92	0		0		133910	0		2
114	48	0		0		111622	0		2
113	79	0		0		140410	0		2
112	134	0		0		257258	0		2
105	132	0		0		282689	0		3
107	99	0		0		196627	0		3
106	135	0		0		299905	0		3
102	74	0		0		93770		0		3
109	12	0		0		76300		0		4
103	82	0		0		161407	0		4
110	69	0		0		103744	0		4


6. List number of employees with their total sales (SUBTOTAL), total shipping charge, total tax, and overall total SALESs.
EMPLOYEE_NO, TOTAL SALES, TOTAL SHIPPING CHARGES, TOTAL TAXES, TOTAL OVERALL SALES (3)

SELECT EMPLOYEE_NO, SUM(SUBTOTAL) "TOTAL SALES", 
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL SALES"
FROM ORDERS 
GROUP BY EMPLOYEE_NO;

1067	0		0		65399		0
1084	0		0		48810		0
1005	918445	76136		76411		1041934
1003	656088	25200		127839	712588
1002	0		0		30585		0
1006	0		0		31346		0
1047	0		0		0		0
1080	0		0		40420		0
1011	0		0		84930		0
1066	0		0		37660		0
1012	0		0		29550		0
1088	0		0		28545		0
1036	0		0		168519	0
1037	0		0		107670	0
1059	0		0		44470		0
1071	0		0		30920		0
1076	0		0		14735		0
1053	0		0		7700		0
1073	0		0		19350		0
1000	0		0		0		0
1052	0		0		35100		0
1015	432000	14200		33600		470800
1023	0		0		4500		0
1054	0		0		0		0
1019	0		0		30650		0
1046	0		0		0		0
1029	0		0		58230		0
1041	0		0		28970		0
1070	0		0		4350		0
1035	0		0		114170	0
1079	0		0		27017		0
1031	0		0		25920		0
1022	0		0		0		0
1064	0		0		46475		0
1060	0		0		5250		0
1065	0		0		3900		0
1024	0		0		4050		0
1033	0		0		54300		0
1038	0		0		46990		0
1069	0		0		48200		0
1020	0		0		32700		0
1016	218000	9800		23000		250800
1078	0		0		31500		0
1021	0		0		36520		0
1013	0		0		33210		0
1004	264202	7968		39674		288401
1034	0		0		31400		0
1045	0		0		70982		0
1087	0		0		55014		0
1008	0		0		35358		0
1026	0		0		0		0
1042	0		0		104940	0
1027	0		0		51352		0
1001	0		0		25883		0
1074	0		0		37590		0
1014	231000	10600		97550		263400
1043	0		0		76300		0
1030	0		0		0		0
1086	0		0		32494		0
1025	0		0		48700		0
1061	0		0		0		0
1032	0		0		54380		0
1062	0		0		26679		0
1075	0		0		500		0
1010	0		0		17750		0
1039	0		0		145245	0
1028	0		0		51825		0
1077	0		0		64887		0
1056	0		0		28450		0
1040	0		0		125645	0



7. Redo Query 6 using ROLLUP (.5)


SELECT EMPLOYEE_NO, SUM(SUBTOTAL) "TOTAL SALES", 
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL SALES"
FROM ORDERS 
GROUP BY ROLLUP(EMPLOYEE_NO)
ORDER BY 1;

NULL	2719735	143904	2946059	3027923
1000	0		0		0		0
1001	0		0		25883		0
1002	0		0		30585		0
1003	656088	25200		127839	712588
1004	264202	7968		39674		288401
1005	918445	76136		76411		1041934
1006	0		0		31346		0
1008	0		0		35358		0
1010	0		0		17750		0
1011	0		0		84930		0
1012	0		0		29550		0
1013	0		0		33210		0
1014	231000	10600		97550		263400
1015	432000	14200		33600		470800
1016	218000	9800		23000		250800
1019	0		0		30650		0
1020	0		0		32700		0
1021	0		0		36520		0
1022	0		0		0		0
1023	0		0		4500		0
1024	0		0		4050		0
1025	0		0		48700		0
1026	0		0		0		0




8. Redo Query 6 using CUBE. (.5)

SELECT EMPLOYEE_NO, SUM(SUBTOTAL) "TOTAL SALES", 
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL SALES"
FROM ORDERS
GROUP BY CUBE(EMPLOYEE_NO)
ORDER BY 1;



NULL	2719735	143904	2946059	3027923
1000	0		0		0		0
1001	0		0		25883		0
1002	0		0		30585		0
1003	656088	25200		127839	712588
1004	264202	7968		39674		288401
1005	918445	76136		76411		1041934
1006	0		0		31346		0
1008	0		0		35358		0
1010	0		0		17750		0
1011	0		0		84930		0
1012	0		0		29550		0
1013	0		0		33210		0
1014	231000	10600		97550		263400
1015	432000	14200		33600		470800
1016	218000	9800		23000		250800
1019	0		0		30650		0
1020	0		0		32700		0
1021	0		0		36520		0
1022	0		0		0		0


9. Redo query 6 by adding Rank EMPLOYEES based on total SALES (2)

SELECT EMPLOYEE_NO, SUM(SUBTOTAL) "TOTAL SALES", 
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL SALES",
RANK() OVER ( ORDER BY SUM(SUBTOTAL) Desc) AS RANK 
FROM ORDERS 
GROUP BY EMPLOYEE_NO;


1005	918445	76136	76411		1041934	1
1003	656088	25200	127839	712588	2
1015	432000	14200	33600		470800	3
1004	264202	7968	39674		288401	4
1014	231000	10600	97550		263400	5
1016	218000	9800	23000		250800	6
1078	0		0	31500		0		7
1021	0		0	36520		0		7
1013	0		0	33210		0		7
1067	0		0	65399		0		7
1084	0		0	48810		0		7
1043	0		0	76300		0		7
1030	0		0	0		0		7
1086	0		0	32494		0		7
1025	0		0	48700		0		7
1061	0		0	0		0		7
1032	0		0	54380		0		7
1062	0		0	26679		0		7
1075	0		0	500		0		7
1010	0		0	17750		0		7


10. Redo query 6 by showing percentage of sales/ or sales for each state (2)
			PRODUCT_CATEGORY	QTY_SOLD
SELECT EMPLOYEE_NO, SUM(SUBTOTAL) "TOTAL SALES", 
SUM(SHIPPING_CHARGE)  "TOTAL SHIPPING CHARGES", 
SUM(TAX_AMT) "TOTAL TAXES", SUM(TOTAL_AMT) "TOTAL OVERALL SALES",
NTILE(4) OVER ( ORDER BY  SUM(SUBTOTAL) DESC ) Quartile
FROM ORDERS 
GROUP BY EMPLOYEE_NO;




1005	918445	76136	76411	 1041934	1
1003	656088	25200	127839 712588	1
1015	432000	14200	33600	 470800	1
1004	264202	7968	39674	 288401	1
1014	231000	10600	97550	 263400	1
1016	218000	9800	23000	 250800	1
1078	0		0	31500		0	1
1021	0		0	36520		0	1
1013	0		0	33210		0	1
1067	0		0	65399		0	1
1084	0		0	48810		0	1
1043	0		0	76300		0	1
1030	0		0	0		0	1
1086	0		0	32494		0	1
1025	0		0	48700		0	1
1061	0		0	0		0	1
1032	0		0	54380		0	1
1062	0		0	26679		0	1
1075	0		0	500		0	2
1010	0		0	17750		0	2




11. List all product NUMBERs, PRODUCT_CATEGORY, and number of products sold (2)
			PRODUCT_NUMBER, PRODUCT_CATEGORY, QTY_SOLD

SELECT PRODUCT_NO AS PRODUCT_NUMBER,PRODUCT_CATEGORY,ORDER_QTY AS QTY_SOLD FROM PRODUCT;

120	Game			20
130	Game			40
140	Game			35
150	Game			20
160	Entertainment	5
170	Entertainment	5
180	Software		25
190	Software		25
200	Hardware		60



12. List TOP 25% of customers (customer number, customer last name) based on total net purchases ( their total subtotal â€“ their total amount returned) (3)

SELECT CS.CUSTOMER_NO,CS.LNAME, 
NTILE(4) OVER ( ORDER BY SUM(O.SUBTOTAL)-SUM(O.TOTAL_AMT)  DESC) Quartile
FROM ORDERS O
JOIN CUSTOMER CS ON CS.CUSTOMER_NO = O.CUSTOMER_NO
group by CS.CUSTOMER_NO,CS.LNAME;


1025	George		1
1029	Jake			1
1030	Somers		1
1031	Pregmon		1
1032	Farmer		1
1033	Prouty		1
1034	Mudd			1
1035	Katz			1
1036	Claggett		1
1037	Bixler		1
1038	Dunn			1
1039	Stansbury		1
1040	Mayfield		1
1041	Beckley		1
1042	Murthy		1
1043	Worral		1
1044	Wright		1
1045	Stone			1
1046	Martin		1
1047	Heisler		1


